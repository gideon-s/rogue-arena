// Generated by CoffeeScript 1.7.1
(function() {
  window.Player = (function() {
    function Player(location) {
      this.location = location;
      this.draw();
      window.setTimeout(((function(_this) {
        return function() {
          return _this.act();
        };
      })(this)), 2000);
      window.addEventListener("keydown", this);
    }

    Player.prototype.getSpeed = function() {
      return 100;
    };

    Player.prototype.getLocation = function() {
      return this.location;
    };

    Player.prototype.handleEvent = function(e) {
      return this.lastCode = e.keyCode;
    };

    Player.prototype.moveDir = function(dirIndex) {
      var dir, nextLocation;
      dir = ROT.DIRS[8][dirIndex];
      nextLocation = this.location.addDir(dir);
      if (!Game.map.isOpen(nextLocation)) {
        return;
      }
      Game.drawMapLocation(this.location);
      this.location = nextLocation;
      return this.draw();
    };

    Player.prototype.fire = function(dirIndex) {
      var dir;
      dir = ROT.DIRS[8][dirIndex];
      return new Projectile(this.location, dir);
    };

    Player.prototype.act = function(e) {
      var keyMap;
      keyMap = {};
      keyMap[13] = keyMap[32] = (function(_this) {
        return function() {
          return _this.checkBox();
        };
      })(this);
      keyMap[87] = (function(_this) {
        return function() {
          return _this.moveDir(0);
        };
      })(this);
      keyMap[69] = (function(_this) {
        return function() {
          return _this.moveDir(1);
        };
      })(this);
      keyMap[68] = (function(_this) {
        return function() {
          return _this.moveDir(2);
        };
      })(this);
      keyMap[67] = (function(_this) {
        return function() {
          return _this.moveDir(3);
        };
      })(this);
      keyMap[88] = (function(_this) {
        return function() {
          return _this.moveDir(4);
        };
      })(this);
      keyMap[90] = (function(_this) {
        return function() {
          return _this.moveDir(5);
        };
      })(this);
      keyMap[65] = (function(_this) {
        return function() {
          return _this.moveDir(6);
        };
      })(this);
      keyMap[81] = (function(_this) {
        return function() {
          return _this.moveDir(7);
        };
      })(this);
      keyMap[89] = (function(_this) {
        return function() {
          return _this.moveDir(0);
        };
      })(this);
      keyMap[85] = (function(_this) {
        return function() {
          return _this.moveDir(1);
        };
      })(this);
      keyMap[68] = (function(_this) {
        return function() {
          return _this.moveDir(2);
        };
      })(this);
      keyMap[77] = (function(_this) {
        return function() {
          return _this.moveDir(3);
        };
      })(this);
      keyMap[78] = (function(_this) {
        return function() {
          return _this.moveDir(4);
        };
      })(this);
      keyMap[66] = (function(_this) {
        return function() {
          return _this.moveDir(5);
        };
      })(this);
      keyMap[71] = (function(_this) {
        return function() {
          return _this.moveDir(6);
        };
      })(this);
      keyMap[84] = (function(_this) {
        return function() {
          return _this.moveDir(7);
        };
      })(this);
      keyMap[38] = (function(_this) {
        return function() {
          return _this.fire(0);
        };
      })(this);
      keyMap[33] = (function(_this) {
        return function() {
          return _this.fire(1);
        };
      })(this);
      keyMap[39] = (function(_this) {
        return function() {
          return _this.fire(2);
        };
      })(this);
      keyMap[34] = (function(_this) {
        return function() {
          return _this.fire(3);
        };
      })(this);
      keyMap[40] = (function(_this) {
        return function() {
          return _this.fire(4);
        };
      })(this);
      keyMap[35] = (function(_this) {
        return function() {
          return _this.fire(5);
        };
      })(this);
      keyMap[37] = (function(_this) {
        return function() {
          return _this.fire(6);
        };
      })(this);
      keyMap[36] = (function(_this) {
        return function() {
          return _this.fire(7);
        };
      })(this);
      if ((this.lastCode != null) && (this.lastCode in keyMap)) {
        keyMap[this.lastCode]();
      }
      this.lastCode = null;
      return window.setTimeout(((function(_this) {
        return function() {
          return _this.act();
        };
      })(this)), 50);
    };

    Player.prototype.draw = function() {
      return Game.draw(this.location, "@", "#ff0");
    };

    Player.prototype.checkBox = function() {
      if (Game.map.at(this.location) !== "*") {
        return alert("There is no box here!");
      } else if (_.isEqual(this.location, Game.prize)) {
        alert("Hooray! You found the gem of success and won this game.");
        window.removeEventListener("keydown", this);
        return location.reload();
      } else {
        return alert("This box is empty :-(");
      }
    };

    return Player;

  })();

}).call(this);
