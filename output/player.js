// Generated by CoffeeScript 1.7.1
(function() {
  window.Player = (function() {
    function Player(location) {
      this.location = location;
      this.draw();
    }

    Player.prototype.getSpeed = function() {
      return 100;
    };

    Player.prototype.getLocation = function() {
      return this.location;
    };

    Player.prototype.act = function() {
      Game.engine.lock();
      return window.addEventListener("keydown", this);
    };

    Player.prototype.handleEvent = function(e) {
      var code, dir, keyMap, nextLocation;
      code = e.keyCode;
      if (code === 13 || code === 32) {
        this.checkBox();
        return;
      }
      keyMap = {};
      keyMap[38] = 0;
      keyMap[33] = 1;
      keyMap[39] = 2;
      keyMap[34] = 3;
      keyMap[40] = 4;
      keyMap[35] = 5;
      keyMap[37] = 6;
      keyMap[36] = 7;
      if (!(code in keyMap)) {
        return;
      }
      dir = ROT.DIRS[8][keyMap[code]];
      nextLocation = Util.addDir(this.location, dir);
      if (!Game.map.isOpen(nextLocation)) {
        return;
      }
      Game.drawMapLocation(this.location);
      this.location = nextLocation;
      this.draw();
      window.removeEventListener("keydown", this);
      return Game.engine.unlock();
    };

    Player.prototype.draw = function() {
      return Game.draw(this.location, "@", "#ff0");
    };

    Player.prototype.checkBox = function() {
      if (Game.map.at(this.location) !== "*") {
        return console.log("There is no box here!");
      } else if (this.location === Game.ananas) {
        console.log("Hooray! You found the gem of success and won this game.");
        Game.engine.lock();
        return window.removeEventListener("keydown", this);
      } else {
        return console.log("This box is empty :-(");
      }
    };

    return Player;

  })();

}).call(this);
