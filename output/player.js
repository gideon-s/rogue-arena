// Generated by CoffeeScript 1.7.1
(function() {
  var Player;

  window.Player = (function() {
    function Player(pair) {
      this.location = pair;
      this.speed = 100;
    }

    Player.prototype.getLocation = function() {};

    return Player;

  })();

  Player = function(x, y) {
    this._x = x;
    this._y = y;
    return this._draw();
  };

  Player.prototype.getSpeed = function() {
    return 100;
  };

  Player.prototype.getX = function() {
    return this._x;
  };

  Player.prototype.getY = function() {
    return this._y;
  };

  Player.prototype.act = function() {
    Game.engine.lock();
    return window.addEventListener("keydown", this);
  };

  Player.prototype.handleEvent = function(e) {
    var code, dir, keyMap, newX, newY;
    code = e.keyCode;
    if (code === 13 || code === 32) {
      this._checkBox();
      return;
    }
    keyMap = {};
    keyMap[38] = 0;
    keyMap[33] = 1;
    keyMap[39] = 2;
    keyMap[34] = 3;
    keyMap[40] = 4;
    keyMap[35] = 5;
    keyMap[37] = 6;
    keyMap[36] = 7;
    if (!(code in keyMap)) {
      return;
    }
    dir = ROT.DIRS[8][keyMap[code]];
    newX = this._x + dir[0];
    newY = this._y + dir[1];
    if (!Game.map.isOpen([newX, newY])) {
      return;
    }
    Game.display.draw(this._x, this._y, Game.map.at([this._x, this._y]));
    this._x = newX;
    this._y = newY;
    this._draw();
    window.removeEventListener("keydown", this);
    return Game.engine.unlock();
  };

  Player.prototype._draw = function() {
    return Game.display.draw(this._x, this._y, "@", "#ff0");
  };

  Player.prototype._checkBox = function() {
    var playerLocation;
    playerLocation = [this._x, this._y];
    if (Game.map.at(playerLocation) !== "*") {
      return console.log("There is no box here!");
    } else if (playerLocation === Game.ananas) {
      console.log("Hooray! You found the gem of success and won this game.");
      Game.engine.lock();
      return window.removeEventListener("keydown", this);
    } else {
      return console.log("This box is empty :-(");
    }
  };

}).call(this);
